
{% block xtrajs %}
<script type="text/javascript">
/* <![CDATA[ */

function deleteClass() {
    if (confirm('Are you sure you would like to delete this class? \n Since you are an admin, you can delete this class with students.')) {
       return true;
    }
    return false;
}
function assignRoom(clsid){
    form = document.getElementById('assignroom-'+clsid)
    form.submit();
}

var checks = {
{% for check in program.checkitems.all %}
     "{{ check.id|addslashes }}": "{{check.title|addslashes}}",
{% endfor %}
};

function clickCheckMark(class,check,id) {

  var callback = {
      failure:function(o){},
      success:function(o){
        if (o.responseText == 'On') {
          off = ''; offTitle = '';
        } else {
          off = 'no'; offTitle = 'Not ';
        }

        document.getElementById(id).innerHTML = '<img src="{{media_url}}images/'+off+'checkmark.gif" title="'+offTitle+checks[check]+'" />';
      }
  };

  var url='/manage/{{program.getUrlBase}}/alter_checkmark/';
  var post='class_id='+class+'&check_id='+check;

  /* make the ajax call */
  YAHOO.util.Connect.asyncRequest('POST', url, callback, post);

}

/* ]]> */
</script>

{% endblock %}

<link rel="stylesheet" href="/media/styles/battlescreen.css" type="text/css" />
<style type="text/css">
  .unapproved { 
      text-decoration: underline;
      text-style: italic;
      color: #009;
   }
.class_checkitem { 
   padding:0 !important;
   margin: 0 !important;
}

.checkmark img {
   border: 1px solid #999;
   margin: 2px !important;
}

.class_checkitem a:hover img {
   border: 1px solid black !important;
}

</style>
<hr />

<br />
<div class="info">If you need to email a class, students, or teachers, just use its code!<br />
For instance, if the code is M100:<br />
<tt>M100-students@esp.mit.edu</tt> will email the students,<br />
<tt>M100-teachers@esp.mit.edu</tt> will email the teachers,<br />
and <tt>M100-class@esp.mit.edu</tt> will email everyone in the class.
</div>
<br />

<div id="battlescreen">
<table cellpadding="4px" cellspacing="0" align="center">
  <tr>
    <th colspan="8">
       Manage the classes of {{program.niceName}}
    </th>
  </tr>
  {% if noclasses %}
  <tr>
  <tr>
    <td class="clsleft classname">
      <em>(None available)</em>
    </td>
{% for check in program.checkitems.all %}<td>&nbsp;</td>{% endfor %}
   </tr>
  {% endif %}

  {% for cls in classes %}
  <tr>
    <td class="clsleft classname">
      <span title="{{cls}}">
      <strong>{{cls.emailcode }}.</strong>
      <span       {% if cls.isAccepted %}
      class="approved"
      {% else %}
      class="unapproved"
      {% endif %}> {{ cls|truncatewords:6 }}</span>
      </span>
    </td>
    <td class="clsleft classname" style="font-size: 60%; font-style: italic;">
      <span title="Teacher Names">
         ({{ cls.getTeacherNames|join:", " }})
      </span>
    </td>


    <td class="clsmiddle">
       <form method="post" action="/teach/{{ program.url }}/editclass/{{cls.id }}">
         <input type="hidden" name="command" value="edit_class_{{cls.id}}">
         <input class="button" type="submit" value="Edit">
       </form>
    </td>
    <td class="clsmiddle">
      <a href="/manage/{{program.getUrlBase}}/manageclass/{{cls.id}}" title="Manage {{cls.title}}"
        class="abutton" style="white-space: nowrap;" >
        Manage Class
      </a>
    </td>

{% load class_checkmarks %}
{# checklist ... #}
{% for check in program.checkitems.all %}
    <td class="class_checkitem">
     <a href="/manage/{{program.getUrlBase}}/changeoption/{{cls.id}}?step={{check.id}}"
        title="Change Status of '{{check|addslashes}}'"
        onclick="clickCheckMark({{cls.id}},{{check.id}},'{{cls.id}}-{{check.id}}'); return false;" >
    <span class="checkmark" id="{{cls.id}}-{{check.id}}">
    {% if cls|is_checked:check %}
    <img src="{{media_url}}images/checkmark.gif" title="{{ check.title|escape }}" />
    {% else %}
    <img src="{{media_url}}images/nocheckmark.gif" title="Not {{ check.title|escape }}" />
    {% endif %}
    </span>
{% endfor %}
   </tr>


   {% endfor %}

</table>
</div>