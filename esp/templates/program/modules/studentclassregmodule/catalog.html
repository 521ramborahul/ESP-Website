
{% extends "outlines/series-3.html" %}

{% block title %}{{program.niceName}}{% endblock %}

{% block xtrajs %}
<script type="text/javascript">
<!--
  function submit_prereg(clsid) {
     // prereg for a class
     document.getElementById('submitbutton'+clsid).disabled = true;
     return true;
  }

  function submit_override_prereg(clsid) {
     // prereg for a class
     if (confirm('Are you sure you want to override this block?') &&
         confirm('Are you really sure?!?')) {
        document.getElementById('submitbutton'+clsid).disabled = true;
        return true;
     }
     return false;
  }
//-->
</script>
{% endblock %}

{% block subsection_name %}Course Catalogue{% endblock %}

{% block stylesheets %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="/media/styles/catalog.css" />
{% endblock %}

{% block content %}
{% load latex %}
<br />

<h1>
    {{ program.niceName }} <br /> 
        Course Catalog
</h1>

{% if timeslot %}
<h2 style="text-align: center;">
Viewing classes for: {{ timeslot.friendly_name }}
</h2>
{% endif %}
{% if request.user.onsite_local %}

{% if not request.GET.filter %}
<h2 style="text-align: center;">
<a href="{{request.path}}?filter=True">Filter out invalid classes</a>
</h2>
{% else %}
<h2 style="text-align: center;">
<a href="{{request.path}}">Show all classes</a>
</h2>
{% endif %}
{% endif %}

<div id="catalog">

<table align="center" style="text-align: center; margin: auto;" width="60%" border="0">
 <tr>
  <th colspan="2">
   <a name="top"></a>Jump to Categories
  </th>
 </tr>

{% for category in categories %}
{% if forloop.counter0|divisibleby:2 %}
<tr>{% endif %}
  <td style="width: 50%; vertical-align: top;" valign="top" align="center">

    <a href="#cat{{ category.id }}" title="Click to skip down to `{{ category.category }}'">
              {{category.category}}
    </a>
  </td>
 {% if forloop.counter|divisibleby:2 %}
</tr>{% endif %} 
{% endfor %}
{% if not categories|length|divisibleby:2 %}
</tr>
{% endif %}

</table>
</div>

{% for aclass in courses %}

<div id="catalog">

{% if not aclass.errormsg or not request.GET.filter %}
{% ifchanged %}<hr size="1"/>

    <a name="cat{{aclass.class.category.id}}"></a>
      <p style="font-size: 1.2em;" class="category">
         {{ aclass.class.category }}
      </p>
{% if request.user.onsite_local %}

{% if not request.GET.filter %}
<h2 style="text-align: center;">
<a href="{{request.path}}?filter=True">Filter out invalid classes</a>
</h2>
{% else %}
<h2 style="text-align: center;">
<a href="{{request.path}}">Show all classes</a>
</h2>
{% endif %}
{% endif %}
      <p class="linktop">
         <a href="#top">[ Return to Category List ]</a>
      </p> {% endifchanged %}

<div class="show_class">
  <table cellpadding="5px" cellspacing="0">
    <tr>
      <th colspan="2" style="width: 70%;">
       {{ aclass.class.title|escape|teximages:150 }}
      </th>
	<th style="width: 30%;">
       <span class="teachers">
       {% for teacher in aclass.class.teachers %}
       <a href="/teach/teachers/{{ teacher.last_name|urlencode }}/{{ teacher.first_name|urlencode }}{{ teacher.getUserNum }}/bio.html" 
          title="Click for the biography of {{teacher.first_name }} {{teacher.last_name }}">
          {{ teacher.first_name }} {{teacher.last_name }}
       </a>{% if not forloop.last %},{% endif %}{% endfor %}
       </span>
       </th>
     </tr>
     <tr>
       <td colspan="3" class="info">
         {{ aclass.class.class_info|escape|teximages:120|linebreaksbr }}<br />
       {% if aclass.class.prereqs %}
       <br /><br />
       <em>*Prerequisites*</em>
       <p style="padding-left: 10px; font-style:italic;">
         {{ aclass.class.prereqs }}
       </p>
       {% endif %}
       </td>
     </tr>
    <tr>
      <td style="width: 50%;" valign="top">
        <strong>Meeting Time{{ aclass.class.friendly_times|pluralize }}</strong>
        <br />
	  {{ aclass.class.friendly_times|join:"<br />" }}
        <br />
      </td>
 
      <td style="width: 50%;" colspan="2">
         <strong>Grades:</strong>
           {{ aclass.class.grade_min }}--{{ aclass.class.grade_max }} <br />
         <strong>Enrollment:</strong>
           {{ aclass.class.num_students }} (max {{ aclass.class.class_size_max }})
      </td>
    </tr>
    {% if aclass.class.anchor.media_set.count %}
    <tr>
      <th colspan="3" class="materials">
       <b>Materials for this class include:</b> 
	<span class="doclist">
	{% for doc in aclass.class.docs_summary %}
	<a href="/media/{{ doc.target_file}}">{{ doc.friendly_name }}</a>{% if forloop.last %}{% else %},{% endif %} 
	{% endfor %}
	</span>
	<br /><b><a href="../class_docs/{{ aclass.class.id}}">Click here to view all {{ aclass.class.anchor.media_set.count }} documents for {{ aclass.class.title }}</a></b>
      </th>
     </tr>
    {% endif %}
{% if prereg_url %}
    <tr>
      <td colspan="2" style="text-align: center;" align="center">
     {% if aclass.errormsg %}
<span class="error">{{ aclass.errormsg }}</span> 
{% if request.user.onsite_local %}
<br />
<form name="prereg_submitform" onsubmit="return submit_override_prereg('{{ aclass.class.id }}');" method="post" action="{{ prereg_url }}">
	  <input type="hidden" name="class_id" value="{{ aclass.class.id }}" />
  	  <input type="submit" name="action" value="Add this class anyway!"
                 id="submitbutton{{ aclass.class.id }}" />
</form>
{% endif %}

{% else %}
	<form name="prereg_submitform" onsubmit="return submit_prereg('{{ aclass.class.id }}');" method="post" action="{{ prereg_url }}">
	  <input type="hidden" name="class_id" value="{{ aclass.class.id }}" />
  	  <input type="submit" name="action" value="Add this class"
                 id="submitbutton{{ aclass.class.id }}" />
	</form>{% endif %}
      </td>
     </tr>{% endif %}
</table>

{% endif %}

</div>

<br />
{% endfor %}
</div>

{% endblock %}